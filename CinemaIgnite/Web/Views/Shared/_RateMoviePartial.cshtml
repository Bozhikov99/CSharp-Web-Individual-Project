@if (ViewBag.IsLoggedIn)
{

    @if (ViewBag.HasRating)
    {
        <button id="rate-toggle" class="btn-danger rated">@ViewBag.Rating/10</button>
    }
    else
    {
        <button id="rate-toggle" class="btn-danger unrated">Rate</button>
    }


    <div class="rate-div" hidden>
        @for (int i = 0; i < 10; i++)
        {
            <button class=btn-primary value=@(i+1)>@(i+1)</button>
        }
        <input id="rating-input" disabled="true" value="">
        <button id="rate" class="btn-warning">Rate</button>
    </div>
}

<script type="text/javascript">
    let inputElement=document.querySelector('#rating-input');
    let rateButtonElement=document.querySelector('#rate');

    let rateToggleElement=document.querySelector('#rate-toggle');

    rateButtonElement.addEventListener('click', ()=>{
        let inputValue=inputElement.value;
        $.ajax({
        type: "POST",
        url: "@Url.Action("RateMovie")",
        data: { movieId: '@ViewBag.MovieId', value: Number(inputValue)}
        })
        .then((result)=>{
             //Worked just fine and suddenly glitched after I Added the Web API. Couldn't fix it
            rateToggleElement.textContent=`${inputValue}/10`;
        })
        .fail((result)=>{
            rateToggleElement.textContent=`${inputValue}/10`;
        });
    })
</script>